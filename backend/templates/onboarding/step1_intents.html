<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Onboarding - Step 1</title>
  </head>
  <body>
    <h1>What are you here for?</h1>

    <form id="form">
      <label><input type="checkbox" name="intent" value="CASHFLOW" /> Track cashflow</label><br />
      <label><input type="checkbox" name="intent" value="SPENDING" /> Monitor spending</label><br />
      <label><input type="checkbox" name="intent" value="BUDGETS" /> Set budgets</label><br />
      <label><input type="checkbox" name="intent" value="NET_WORTH" /> Track net worth</label><br />
      <label><input type="checkbox" name="intent" value="HABITS" /> Build better habits</label><br /><br />

      <button type="submit">Continue</button>
    </form>

    <script>
      document.getElementById("form").addEventListener("submit", async (e) => {
        e.preventDefault();
        const intents = Array.from(document.querySelectorAll('input[name="intent"]:checked'))
          .map((el) => el.value);

        const res = await fetch("/api/users/onboarding/save", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ product_intents: intents }),
        });

        if (!res.ok) {
          alert("Failed to save. Try again.");
          return;
        }

        window.location.href = "/app/onboarding/2/";
      });
    </script>
  </body>
</html>
